apiVersion: cron-agent/v1
kind: CronTask
metadata:
  id: summary-monthly
  name: Summary Monthly
  enabled: true
spec:
  mode: agent
  runBackend: cron
  schedule:
    cron: "0 11 1 * *"
    timezone: Asia/Shanghai
    maxConcurrency: 1
    misfirePolicy: run_once
  input:
    prompt: |
      Generate this month's summary from existing daily/weekly summaries and save it into journal/monthly.
      Required outcome:
      1) Use local project logic/data to generate monthly output.
      2) Ensure monthly markdown artifact is updated under configured output_root journal/monthly.
      3) Return a concise Chinese summary of the generated result.
  execution:
    timeoutSeconds: 180
    workingDirectory: "."
    retry:
      maxAttempts: 1
      backoffSeconds: 0
  modeConfig:
    agent:
      provider: codex_cli
      model: gpt-5-codex
      sandboxMode: workspace-write
  output:
    sink: file
    pathTemplate: artifacts/{task_id}/{run_id}/result.txt
    format: text
  logging:
    eventJsonlPath: logs/runs/{date}.jsonl
