apiVersion: cron-agent/v1
kind: CronTask
metadata:
  id: summary-weekly
  name: Summary Weekly
  enabled: true
spec:
  mode: agent
  runBackend: cron
  schedule:
    cron: "0 10 * * 1"
    timezone: Asia/Shanghai
    maxConcurrency: 1
    misfirePolicy: run_once
  input:
    prompt: |
      Generate this week's summary from existing daily summaries/records and save it into journal/weekly.
      Required outcome:
      1) Use local project logic/data to generate weekly output.
      2) Ensure weekly markdown artifact is updated under configured output_root journal/weekly.
      3) Return a concise Chinese summary of the generated result.
  execution:
    timeoutSeconds: 180
    workingDirectory: "."
    retry:
      maxAttempts: 1
      backoffSeconds: 0
  modeConfig:
    agent:
      provider: codex_cli
      model: gpt-5-codex
      sandboxMode: workspace-write
  output:
    sink: file
    pathTemplate: artifacts/{task_id}/{run_id}/result.txt
    format: text
  logging:
    eventJsonlPath: logs/runs/{date}.jsonl
